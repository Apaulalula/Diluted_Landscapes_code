# Host parasite metacommunity and coevolutionary model

## `Code`
Code for model simulations, created in Julia version 1.4.1 or R version 4.3.1.

### `setup`
Directory with scripts used to generate landscape scenarios and species parameters. 
- `generate_landscapes.R` - build landscapes with a specified number of patches, fraction of forest and forest clustering; output saved into `Data/landscapes` directory
- `generate_landscpaes_edge.jl` - reads landscapes generated by `generate_landscpaes.R` and reclassifies patches according to their neighbourhood; output saved into `Data/landscapes` directory
- `generate_species_parameters.R` - generate theta parameter values for each species in a chosen network and number of replicas; interaction network incidence matrix must be saved as `Minc.csv` and host habitat preferences as `host_types.csv` in `Data/metanetwork` directory; output saved into `Data/metanetwork` directory

### `simulations_v2b` and `simulations_v2b_phi`
These directories contain scripts for running the simulations with host colonisation and extinction probabilities dependent on host forest occurrences and forest neighbourhood. 
`simulations_v2b_phi` contains scripts for running the model version without host evolution. 

- `run_model.jl` - script for running simulations (see instructions at the end of the file); multiple simulations can be run in parallel; specify model parameters inside `run_parallel` function
- `functions_master.jl`, `functions_setup.jl`, `functions_extinction_colonisation.jl`, `functions_coevolution_evolution.jl`- scripts defining functions needed for running simulations

## `Code_results`
Code for analysing model output data, created in R version 4.3.1.
- `1_build_local_networks.R` - build local networks for all patches of each generated landscape
- `2_metrics_local_networks.R` - calculate network metrics for each local network - size, connectance, nestdness and modularity
- `3_trait_matching.R` - calculate the trait matching of host and parasites in each patch of each generated landscape
- `4_summarise_model_results_a0.2.R` - summarise the model output results by patch habitat type and calculate the parasite global extinction rate, relative degree and host abundance.
- `5_prst_metric_analysis.R` - statistical model analysis of the ecological and evolutionary outputs
- `5.1_prst_analysis_plots.R` - plot of the statistical model results
- `6_beta_analysis.R` - calculate beta diversity of interactions within and between patches and build their statistical analyses.
- `6.1_beta_analysis_plots.R` - built plot of the beta diversity model results

## `Data`

### `landscapes`
This directory contains the data generated by `generate_landscapes.R`

### `metanetwork`
This directory contains the network incidence matrix (must be uploaded), host habitat preferences (must be uploaded), and the data generated by `generate_species_parameters.R`.

## `Output_v2b`
This directory contains all simulation output files.

## `Output_v2b_phi`
This directory contains all simulation output files for the model version without host evolution.

## `Results_v2b`
This directory stores any files created by the scripts in `Code_results`
